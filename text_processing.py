import sqlite3
import copy

# text processing


# here's the experimental data set
succession_texts = {
    'mg1': """Some of the most frequent zonations involving Arrhenatheretum stands are the often sharp juxtapositions of the various sub-communities and variants with one another or with other vegetation types along road margins. Such patterns are very varied and sometimes reflect long, local traditions of boundary construction and maintenance. Where stands are not maintained by cutting, zonations are generally a reflection of stages in succession to mixed deciduous woodland. This succession is most often mediated by grazing. Arrhenatherum is a ready invader of soils and calcareous talus exposed by landslip, construction work or the abandonment of ploughed land. It can also spread into and increase in certain other grassland types where grazing is absent or withdrawn or where there is injudicious pastoral treatment. Resumption of grazing can once more reduce its cover. Hope-Simpson (1940b) noted that, within four years of the removal of rabbits from a primitive Festuca ovina-Avenula pratensis sward at War Down, Hampshire, Arrhenatherum previously no more than occasional, had become very abundant. Within seven years of the resumption of grazing by sheep and rabbits on an Arrhenatheretum at nearby Coulter’s Dean Wasteland, the vegetation had been converted to a Festuca ovina-Avenula pratensis grassland with no Arrhenatherum (Hope-Simpson 1940b). Thomas (1960, 1963) showed that, after the virtual elimination of rabbits by myxomatosis, the coarser grasses characteristic of the Arrhenatheretum were among those species which spread in grasslands and heaths on chalk. These had previously been present in small amounts and had provided a valuable winter-green bite for the rabbits. They were reduced in cover when rabbit numbers rose again. Arrhenatherum can also spread into seeded verges and some of the floristic variation within the Festuca rubra sub-community (see above) is attributable to this advance. Increase of Arrhenatherum in Centaureo-Cynosuretum grasslands seems to follow careless grazing, perhaps by the use of such grasslands as horse-paddocks, and the Centaurea nigra sub-community of the Arrhenatheretum may originate partly in this way. Ploughing and subsequent abandonment of land after unsuccessful arable cultivation seems to have been a fairly widespread factor in the development of some of the more extensive stands of the community, especially on deeper soils over chalk. The Arrhenatheretum at Coulter’s Dean Wasteland had developed on land ploughed and abandoned some 30 years before (Tansley & Adamson 1925). Brenchley & Adam (1915) had reported a similar occurrence of the community on the abandoned and ungrazed Broadbalk Wilderness at Rothamsted. Several subsequent studies (Lloyd & Pigott 1967 in the Chilterns, Grubb et al. 1969 at Lullington Heath, Sussex and Wells et al. 1976 at Porton Down on the Hampshire/Wiltshire border) have confirmed the view that the Arrhenatheretum is one of the communities dominated by coarse grasses which can, in the absence of grazing, develop naturally on the chalk without the prior development of a Festuca ovina-Avenula pratensis sward. The Arrhenathereta described in these studies are of the kind classified here as the Pastinaca and Centaurea nigra sub-communities but the lists provided are generally insufficiently precise to allocate stands unequivocally to one or the other. The available data suggest that the Pastinaca sub-community develops on the more calcareous and oligotrophic soils where these have been exposed by ploughing or where there has been a relaxation of grazing of calcicolous grassland. This sub-community is most common on the chalk of the south and east where P. sativa has its centre of distribution in Britain and where there has been a history of unsuccessful arable cultivation of marginal chalkland and pastoral neglect (see, for example, Smith 1980). The Centaurea sub-community is more widespread and seems to develop on more mesotrophic soils which are generally less calcareous. It is perhaps the more natural sub-community on deeper soils over chalk, such as those derived from superficial deposits, but it may also develop by the relaxation of grazing of mesotrophic grasslands throughout the lowlands, especially where this has been combined with application of fertilisers. Similar differences in the trophic state of soils may be an important factor in controlling whether it is Arrhenatheretum (of any kind) or grassland dominated by other coarse species such as Avenula pubescens, Festuca rubra, Bromus erectus and Brachypodium pinnatum which develops in any given situation. Wells et al. (1976) showed that, at Porton, the Arrhenatheretum occurred on land ploughed relatively recently where, they suggested, there was still a comparatively small accumulation of organic matter and mineral nutrients. Other coarse grassland types had developed on soils ploughed less recently which were consequently richer. If any kind of Arrhenatheretum remains ungrazed and uncut it eventually develops a pronounced tussock physiognomy and litter accumulation depresses species-richness. Shrubs invade and the frequently close hedgerows and field boundaries provide a seed source. Foremost among the invaders is Crataegus monogyna with Prunus spinosa, Sambucus nigra (especially where there has been disturbance and soil eutrophication), Rubus fruticosus agg., Rosa spp. and, on the more calcareous soils, Cornus sanguinea, Viburnum lantana and Ligustrum vulgare. Clematis vitabla may form a tangle among the developing scrub. Eventually, succession progresses to some form of mixed deciduous woodland but even very coarse and scrubby Arrhenatheretum can be converted to a low sward by grazing. At Aston Rowant NNR, Oxfordshire, four years of sheep-grazing in winter and spring drastically reduced the height of a scrubby Arrhenatheretum and converted A. elatius itself from large tussocks to small scattered shoots in a ground of Festuca ovina (Wells 1969: compare especially Figures 1 and 2).""",
    'mg2': """Spatial transitions between the Filipendulo-Arrhenatheretum and other vegetation types are partly controlled by the sharpness of local topographic discontinuities. Stands are often small and fragmentary and confined to ledges and embayments, giving way abruptly on less sheltered, sunnier slopes to the local form of calcicolous grassland. Where the vegetation is open to stock, grazing may blur the zonation. There is sometimes a gradation to mixed deciduous woodland of the Fraxinus-Acer-Mercurialis or Fraxinus-Sorbus-Mecurialis types. However, although many sites may formerly have had a more extensive local woodland cover, the broken terrain on which the community is typically found could never have been densely wooded (Pigott 1958). The Filipendulo-Arrhenatheretum should therefore be regarded as a persistent woodland margin community rather than a serai precursor. The occasional association of the community with old mixed hedgerows is interesting in this respect.""",
    'mg3': """Stands of the Anthoxanthum-Geranium community occur most frequently in fields bounded by walls or fences and each subject to a more or less uniform treatment regime. Spatial zonations between the sub-communities are therefore infrequent, although neglected corners and margins of fields with either the Briza or the Bromus sub-community may show a narrow transition to the Arrhenatherum sub-community. The blue-violet flowers of Geranium pratense often mark out this sub-community in summer. On verges which have a less systematic treatment such transitions are more common and irregular. The local appearance of mire species in stands of the Anthoxanthum-Geranium community may form part of a transition to flush vegetation where drainage of soil water is strongly impeded. The types of mire involved in such sequences depend on the calcium status and pH of the ground water and include the Pinguiculo-Caricetum and the Molinia-Crepis fen. Along stream sides where there is seasonal inundation a tall-herb Filipendulion mire may terminate the sequence. The striking floristic similarity between the Anthoxanthum-Geranium community and the field layer of open stands of the Fraxinus-Sorbus-Mercurialis and Alnus-Fraxinus-Lysimachia woodlands strongly suggests that this meadow vegetation has developed by canopy clearance and is maintained by annual mowing which excludes tall dominants (Pigott 1956a, Bradshaw 1962). Zonations between the community and such woodland are rare but occasionally the two vegetation types occur contiguously on identical sites separated only by a boundary wall. In Scandinavia, very similar meadow vegetation is mown in the clearings of such open woodland (Nordhagen 1928, Sjörs 1954; see ‘Affinities’ below). Traditional treatment has maintained the community in all its richness but the vegetation of the Bromus sub-community represents one stage in a process of increasing the productivity and decreasing the floristic diversity of hay-meadows in response to various combinations of fertiliser application, ploughing and re-seeding. This seems eventually to convert the vegetation to the Holcus-Trifolium sub-community of Festuca-Agrostis-Galium grassland or the Anthoxanthum sub-community of the Lolio-Cynosuretum.""",
    'mg4': """Stands of the community frequently show considerable variation in the abundance of particular species. Some of this is related to the distinctive bushy (e.g. S. officinalis and F. ulmaria) or tussock (e.g. larger grasses) habit of certain components but local variations in treatment, such as differences in mowing-time, continued over long periods, may also have an effect (Ratcliffe 1977). Zonations to other communities are most frequently related to differences in soil moisture status. Damp hollows in meadows sometimes show gradations to the Holcus lanatus-Deschampsia cespitosa community or to the Holco-Juncetum, especially the Juncus inflexus sub-community on more base-rich soils. These in turn may give way to Carex acutiformis swamp. Sharper zonations of this kind can sometimes be seen bordering the older drainage ditches which frequently traverse the meadows or in such places there may be an abrupt switch to the Agrostis stolonifera-Alopecurus geniculatus inundation grassland. Modern ditches around the meadows often have linear stands of Salix spp. or Alnus on their banks. Changes in treatment practice can alter the composition of the Alopecurus-Sanguisorba community and may initiate successions to other grassland types. An extension of grazing into the spring reduces the abundance of some of the most distinctive species of the community such as Sanguisorba officinalis, Silaum silaus and Fritillaria meleagris, all of which are highly palatable. This is the major community in Britain for F. meleagris and, if grazing is continued into its flowering period in late April to early May, it cannot set seed. At Marston Meadows in Staffordshire, a change from mowing to late spring grazing over the last 20 years has extensively reduced its cover (Ratcliffe 1977). It can, however, remain dormant in the soil for a number of years and seems able to recolonise fields from margins or ditch edges. If stands are ungrazed over the winter months, coarse grasses such as Arrhenatherum elatius (in drier places) and Deschampsia cespitosa (in wetter areas) may expand and eventually form stands of the Arrhenatheretum or the Holcus lanatus-Deschampsia cespitosa community. Drainage, ploughing, re-seeding or the addition of artificial fertilisers can all have a more drastic effect on the vegetation. Combined with an increase in grazing, such changes probably convert the community to the Lolium perenne-Alopecurus pratensis-Festuca pratensis flood-pasture or to the Lolio-Cynosuretum.""",
    'mg5': """Zonations in the Centaureo-Cynosuretum are usually related to edaphic patterns and, even in enclosed fields subject to a uniform treatment, there may be soil differences which reflect heterogeneities in the parent material. Within the Galium sub-community, an increase in Mesobromion species (such as Koeleria macrantha and Sanguisorba minor) is often related to a rise in calcium content and pH as the soil thins towards limestone exposures. Such patterns are commonly part of a complete transition from the Centaureo-Cynosuretum to calcicolous grassland on the Carboniferous Limestone of the Yorkshire Dales where meadows on till or head abut on to, or surround, rocky outcrops (cf. Ivimey-Cook & Proctor 1966b on comparable zonations in The Burren). In a similar fashion, there may be an increase of species typical of calcifugous grasslands and heaths in the Danthonia sub-community where its characteristic brown earths grade to rankers or podzolised soils over siliceous material. The patchy occurrence of Juncus spp. or F. ulmaria within stands of the Centaureo-Cynosuretum represents truncated zonations to the Holco-Juncetum or Filipendulion mires which are mediated by the soil moisture status. Such patterns are a common feature of meadows on undulating topography and frequently accentuate ridge-and-furrow with fragmentary strips of F. ulmaria or Juncus spp. on the less well-drained soils of the furrows. Alongside streams there may be a more complete gradation to poorfen vegetation. Occasionally, differences in treatment may be evident as zonations within enclosed meadows as, for example, where narrow belts of rich Centaureo-Cynosuretum remain on steeper banks within fields or around margins which have escaped improvement. Generally, however, differences in treatment style have a gradual successional effect upon the community which is evident in a range of intermediates between the Centaureo-Cynosuretum and more improved and productive grassland types. Two changes of practice are of particular importance. The first is an increase of grazing pressure. Growth starts quite early in the regions where the community occurs and stands may provide a valuable supplementary bite towards the end of April. If grazing is continued into the summer, and especially if it is heavy, there is an eventual decrease in the richness of the sward. Early-flowering species such as Orchis morio are then unable to set seed and there is a gradual expansion of rosette hemicryptophytes. The occurrence of the poisonous Colchicum autumnale in stands of the community has sometimes led to their being set aside for hay but some farmers have destroyed this species so as to allow an expansion of grazing. In fact, C. autumnale is more toxic during the early part of the season than in summer (Butcher 1954). Frequent mowing of the community, as occurs in some churchyards and on some verges and lawns, appears to have a similar effect to an increase in grazing. Although such treatment may permit the survival of an impoverished form of the Centaureo-Cynosuretum, the trend is for the sward to be converted eventually to the Lolio-Cynosuretum. This change may be further encouraged by the second, now very widespread, alteration in treatment. This is the replacement of the traditional farmyard manure by artificial mineral fertilisers. These enhance the growth of the grasses to the detriment of the dicotyledons. Lotus corniculatus and Leontodon hispidus are often the first species to be lost from the vegetation but a much greater impoverishment accompanies the rise in productivity in the long term. More drastic treatments of the community involve ploughing or the use of total weedkillers such as paraquat and re-seeding to produce Lolio-Cynosuretum or various kinds of ley. Such artificial successions to pasture depend ultimately on the maintenance of grazing. When the Centaureo-Cynosuretum or its derivatives are ungrazed, there is an expansion of coarser grasses and an eventual invasion of shrubs. The Lathyrus and Galium sub-communities seem to progress to various types of Arrhenatheretum or, on more calcareous soils, to one of the coarser Mesobromion swards. The exact nature of the succession may also be influenced by the fertiliser regime on the original meadow. Ungrazed stands of the Danthonia sub-community may be directly invaded by heath shrubs or Ulex europeaus. The results of careless grazing are sometimes evident as mosaics of Centaureo-Cynosuretum with patches of coarse grassland or heath. Distribution Stands of the community occur throughout the British lowlands but the centre of distribution is on the claylands of the Midlands. Even here, however, agricultural improvement has drastically reduced the extent of the community. The sub-communities are distributed largely in relation to local and regional variations in soil type. The Lathyrus sub-community is the most widespread type with the Galium sub-community showing a more restricted occurrence, largely over calcareous bedrocks. The Danthonia sub-community extends the altitudinal range of the community on to the upland margins of the Welsh borderlands and northern England. In the harsh montane climate of the northern Pennines the community is replaced by the Anthoxanthum-Geranium community. As with this other increasingly restricted meadow type, verge stands provide a valuable reserve.""",
    'mg6': """The application of careful uniform treatment within enclosed pasture stands of the Lolio-Cynosuretum tends to minimise the occurrence of zonations. However, where past improvement has been uneven, transitions may remain. Steeper banks inaccessible to ploughing may still carry patches of Centaureo-Cynosuretum as remnants of previous meadow vegetation. Hollows resistant to drainage may have the Holcus-Deschampsia community or Holco-Juncetum; the Deschampsia and Iris variants of the Typical sub-community can be seen as truncated zonations to such vegetation which occur where drainage is less successful. Where rivers and pools are not embanked, the Alopecurus geniculatus variant represents part of a transition to the vegetation of regularly-inundated water margins. Where pastures have been won from rocky upland topography, there may be zonations to calcifugous grasslands (with the Anthoxanthum sub-community) or calcicolous grasslands (with the Trisetum sub-community) as the soil thins to some type of lithomorphic profile around outcrops. The Lolio-Cynosuretum can be derived from a very wide range of vegetation types (Figure 9) including, in extreme cases, communities of stabilised sand-dunes and blanket mire. Certain kinds of agricultural treatment or neglect may allow some of the more closely related types of original unimproved vegetation to replace the Lolio-Cynosuretum. In older pastures, a return to more traditional organic manuring and the withdrawal of summer grazing may permit the re-establishment of the meadow vegetation of the Centaureo-Cynosuretum. This is perhaps more likely in the Anthoxanthum and Trisetum sub-communities where certain meadow species persist or where there are fragments of meadow-sward on banks or adjacent verges. Similarly, the choking of drains may permit the development of extensive Holco-Juncetum. Generally, however, successions involving the Lolio-Cynosuretum appear to be mediated by grazing. Undergrazing allows coarser species to increase their cover and this is sometimes a prelude to the invasion and spread of Arrhenatherum elatius and the development of an Arrhenatheretum. Abandoned pasture often shows a patchy mosaic of the two communities with scattered saplings of Crataegus monogyna. Where grazing is too severe, the sward may be opened up for invasion by weeds and rabbit infestation may speed the run-down to some weed-dominated vegetation. Trampling may be an attendant problem with over-grazing by cattle but is especially important in recreational and amenity stands of the Lolio-Cynosuretum where heavy use along footpaths, around gateways and in goal-mouths may produce a succession to Lolio-Plantaginion vegetation.""",
    'mg7': """None""",
    'mg8': """Enclosed stands of the community in riverside pastures may be subject to uniform treatment and show no zonations to other vegetation types. In some cases, however, improvement and management have been restricted by difficult topography and an inability to prevent flooding. Here, and around the more fragmentary spring and flush stands, there may be zonations related to soil moisture conditions. A usual pattern is for the Cynosurus-Caltha community to give way to inundation communities on the bare substrates of river banks or pool-sides or to small-sedge mires of the Caricion davallianae in base-rich flushes. On drier ground, there may be a transition to the Lolium-Alopecurus-Festuca flood-pasture or, where there has been extensive improvement, directly to Lolio-Cynosuretum. Such a sequence can be seen on the drained levels of West Sedgemoor in Somerset. Artificial drainage can mediate a successional sequence from the Cynosurus-Caltha community to drier pasture types but neglect permits a fairly rapid invasion of Salix spp. and other shrubs and trees of wet woodland.""",
    'mg9': """The community occurs very frequently as part of zonations related to differences in soil moisture status. The Poa sub-community is common in moist hollows within pastures and on grazed verges where there is gleying and it commonly gives way, with a decrease in the cover of D. cespitosa, to Lolio-Cynosuretum or the Lolium-Alopecurus-Festuca community on better-drained soils. Around permanently wet hollows, pools and lakes, the community regularly forms part of an ecotone to some type of fen or swamp or, where there is a frequent rise and fall of water level, as around reservoirs, to a sequence of inundation communities. In many cases, it is possible to discern a range of intermediates between the Holcus-Deschampsia community and its neighbours and, in zonations to fen-meadows, there is, or has been in the past, the further complication of mowing and grazing effects. Such transitional swards may also figure in serai changes that ensue in badly-managed or abandoned pastures and meadows. Once established, D. cespitosa cannot be totally eradicated by continued grazing and, if drainage deteriorates, it will slowly spread to dominate in the Poa sub-community. Even where drainage is improved, preferential grazing of other species may prevent D. cespitosa being ousted by possible competitors. Where there is a reduction of grazing on better-drained land, the Arrhenatherum sub-community may develop from pasture swards. Although a switch to mowing is probably the best form of control of D. cespitosa (Davy 1980), the silting up of ditches within meadows may precipitate a spread of the community. If grazing continues, the Holcus-Deschampsia grassland is maintained as a plagioclimax and, even when it ceases, the densely-tussocky character of the vegetation often severely hinders any establishment of seedling shrubs and trees. Where succession to woodland does occur, it is usually to the Deschampsia sub-communities of the Alnus-Fraxinus-Lysimachia or Fraxinus-Acer-Mercurialis woodlands. Stands of the Holcus-Deschampsia grassland can often be found in rides and clearings in tracts of these kinds of woodlands or planted replacements of them in forests on heavy, clay soils with considerable continuity among the herb flora. In such situations, the Holcus-Deschampsia grassland can provide an important seed source for the spread of D. cespitosa beneath the trees when felling or coppicing increases the light.""",
    'mg10': """The community very commonly occurs in mosaics related to patterns of soil moisture. The Typical sub-community is very frequent as patches and sometimes as extensive stands in damper hollows in the Lolio-Cynosuretum and Centaureo-Cynosuretum and distinctive patterns often reflect the occurrence of ridge-and-furrow or drains that are too widely spaced, rushy strips picking out the wetter bands of soil. The Juncus inflexus sub-community is encountered in less well-drained areas within more calcareous soils in the Alopecurus-Sanguisorba flood-meadow and the more calcicolous types of Centaureo-Cynosuretum. The Iris sub-community occurs in often very prominent patches in alluvial Lolio-Cynosuretum in western river valleys. Where the water-table rises beside streams and pools, the Holco-Juncetum may form part of a complete or partial transition from grassland to swamp, fen or inundation communities. Here, as with the field mosaics, there may be a range of intermediate types of vegetation based on the abundance of the dominant Junci. The Holco-Juncetum commonly develops by the invasion of J. effusus and J. inflexus into established or newly-seeded grasslands. A number of studies have demonstrated that J. effusus produces formidable quantities of seed (Chippindale & Milton 1934, Milton 1936, 1948, Moore & Burr 1948, Salisbury 1964) and that these are readily dispersed by wind, by animals and farm machinery after the seed-coat becomes mucilaginous, and by water (Richards & Clapham 1941b, Salisbury 1964). However, two conditions must be fulfilled for germination and survival of the seedlings: light and soil-surface humidity (Moore & Burr 1948, Lazenby 1955a, b, Agnew 1961). Successful invasion is therefore most readily achieved in a broken or badly-seeded sward where the soil surface does not dry out, conditions which are often met in over-grazed and poached pasture or on ill-drained land that is being put down to leys. Once established, the Holco-Juncetum is not readily eradicated. Grazing alone will not reduce the cover of J. effusus or J. inflexus and both are relatively tolerant of mowing. Systematic drainage, re-seeding and fertilising probably convert the community to the Lolium-Alopecurus-Festuca flood-pasture or Lolio-Cynosuretum but careful pastoral management is necessary to prevent re-infestation. Ungrazed stands may be invaded by shrubs and trees tolerant of wet soils and eventually be converted to scrub and woodland.""",
    'mg11': """Zonations involving the community most frequently reflect patterns of soil moisture and, on salt-marshes, the frequency of inundation of salt-laden water. Inland stands of the Lolium sub-community are frequently rather uniform but, where this vegetation occurs patchily in less well-managed grasslands, it grades, on drier ground, to some form of pasture, such as the Lolio-Cynosuretum or the Lolium-Alopecurus-Festuca community, and, around open water, to the Agrostis stolonifera-Alopecurus geniculatus grassland or to more open inundation communities. Salt-marsh stands of the Lolium sub-community and the Atriplex sub-community often pass down-marsh to some form of the Juncus maritimus community or Juncetum gerardi (such as the Leontodon sub-community or its derivatives). Secondary successions to the latter can sometimes be seen in turf-cuttings in the upper marsh which may be quickly colonised by P. anserina and have temporary stands of the Festuca-Agrostis-Potentilla community. Up-marsh, zonations are frequently terminated artificially by a sea-wall or bank but the community sometimes grades to a less frequently inundated form of pasture, free of halophytes. Similarly, the Honkenya sub-community may form a transition zone between more unstable and halophytic Strandline or shingle vegetation and essentially inland grassland. Festuca arundinacea is a sometimes conspicuous occasional in the Festuca-Agrostis-Potentilla community and probably increases its cover with a relaxation of grazing. Zonations between this community and the Potentillo-Festucetum arundinaceae may therefore be a reflection of successions between these two vegetation types mediated by changes in pasturing intensity.""",
    'mg12': """The Lolium-Holcus sub-community generally shows abrupt zonations to other vegetation types, sharpened by treatment where stands abut on to agricultural land or by sudden topographic differences where stands lie on steep banks alongside ditches. Occasionally, there are more gradual zonations to the Festuca-Agrostis-Potentilla community with increased grazing pressure or, on the upper salt-marsh, to the Oenanthe sub-community on more saline soils. Although this latter sub-community sometimes occurs as extensive pure stands, it is frequently encountered in a mosaic with some form of Juncus maritimus salt-marsh which replaces it on more frequently submerged ground.""",
    'mg13': """Small stands commonly form part of the often fragmentary sequences of communities which develop around fluctuating open waters in relation to frequency of inundation and the amount of disturbance by sediment movement and trampling. A frequent pattern is for an intact pasture sward (such as the typical variant of the typical sub-community of the Lolio-Cynosuretum) to give way through an intermediate (the A. geniculatus variant of the same vegetation) to the Agrostis-Alopecurus community on puddled soil around a pool or stream that is used by stock for watering. On moister silts which are more frequently inundated, this in turn may pass to more ephemeral inundation vegetation or to the Glycerietum fluitantis or related assemblages in the Glycerio-Sparganion. In washlands, the community occurs in mosaics with the Glycerietum fluitantis, the Festuca rubra-Agrostis stolonifera-Potentilla anserina inundation grassland and, around dykes, the Phalaridetum arundinaceae and Glycerietum maximae. Where the community occurs around areas of freshwater seepage on the upper salt-marsh, it may pass to more halophytic vegetation types in which A. stolonifera remains prominent.""",
    'cg1':  """Stands of the Festuca-Carlina grassland generally occur as relatively small islands of open, rocky vegetation within more extensive tracts of closed swards or patchworks of grassland, heath and scrub. Much of this variation is explicable in terms of an edaphic transition in moving from the limestone exposures with their often fragmentary and highly calcareous soils to areas of deeper and moister soils which, in the absence of heavy grazing, become invaded by ericoids or other shrubs. In many places, and especially where exposures of bedrock are low and much fractured, the community may cover entire outcrops. In some sites, however, the cliffs are more substantial and here the Festuca-Carlina grassland may become fragmented in the crevices and on the ledges of the rock face and give way over the more massive exposures to fern-dominated stands of the Asplenium trichomanes-Fissidens cristatus community in narrow fissures. Some of the species of the Festuca-Carlina grassland, such as certain of the pauciennials and Draba aizoides, can survive in this more chasmo-phytic vegetation. Elsewhere, on more unstable areas of bare limestone, where there is clitter and shifting accumulations of wind-blown organic and mineral detritus, there can be a transition to the more ephemeral vegetation of the Thero-Airion. On grazed sites (which are the majority), the most common transition around stands of the community is to some form of the Festuca ovina-Avenula pratensis grassland, frequently, on these warm, south-facing slopes, the Helianthemum nummularium-Filipendula vulgaris variant of the Typical sub-community. As the soil cover becomes more continuous and slightly deeper (though remaining calcareous and base-rich), the sward thickens up and there is a switch to a more obviously grass-dominated turf with an increase in Mesobromion dicotyledons and a reduction in the frequency of pauciennials. Often, such junctions are marked by a strong vicarism between either H. apenninum or H. canum and H. nummularium, patterns which have been strikingly depicted by Proctor (1958). In those sub-communities where Koeleria vallesiana occurs (the Carex humilis and Trinia glauca sub-communities), there may be a similar abrupt switch to K. macrantha; elsewhere, this latter species runs right through the grasslands to even the most strongly parched stands of the Festuca-Carlina community. Variations in the sub-surface configuration of the limestone or local accumulations of loess or head can complicate such transitions. Then, more calcifuge communities developed over the deeper and initially less calcareous or superficially leached and acidified soils, can occur in close contact with the Festuca-Carlina grassland. This kind of mosaic is very characteristic where the Festuca-Scilla sub-community occurs on the Gower cliffs in West Glamorgan (South Gower Coast Report 1981). In the more maritime sites, as in Gower and on Brean Down, there is the additional complexity imposed by gradients, running more or less normal to the coastline, of salt-spray deposition. Here, stands of the Festuca-Scilla and Carex humilis sub-communities may have occasional records for certain maritime species and give way towards the sea to the Festuca-Armeria grassland or directly to the crevice vegetation of the Crithmo-Spergularietum on sea-splashed rocks. Likewise, transitions to Thero-Airion and heath communities further up the cliffs may involve more maritime vegetation types like the Armeria-Cerastium therophyte community or the Calluna-Scilla heath. It is doubtful whether grazing is necessary to maintain the openness of the more extreme habitats of the community, where topographic and climatic conditions are probably sufficient to prevent the development of a closed sward, subsequent invasion of shrubs and the formation of a closed woody canopy. However, bird-sown seed of shrubs can germinate in rock crevices and, if grazing is relaxed on the slopes where the community occurs, stands can be encroached upon by scrub relatively quickly: thus, Proctor (1958) noted a marked change in some stands of the Scilla-Euphorbia sub-community on Anstey’s Cove in Devon in only three years following the demise of rabbits from myxomatosis. Ligustrum vulgare seems to be the most characteristic early invader, but Crataegus monogyna, Rubus fruticosus agg. and, at some sites, the Himalayan introduction Cotoneaster microphylla, have also been recorded. In the sunny gaps within this patchy cover, tussocks of Brachypodium sylvaticum can grow up together with prominent plants of Teucrium scorodonia, Geranium sanguineum and Centaurea scabiosa with, in the shade beneath the shrubs, sprawls of Hedera helix. In time, such vegetation probably develops into the kind of wind-cut spinose scrub characteristic of many ungrazed sea cliffs. In some cases, where such scrub is encroaching more slowly from areas of deeper soil, it may grade to the Festuca-Carlina grassland through an intermediate zone of rank Avenula pubescens grassland with its characteristic mixture of Mesobromion herbs, tall grasses and dicotyledons and seedling shrubs or, in more maritime situations, through the Festuca rubra-Daucus carota ssp. gummifer grassland (South Gower Coast Report 1981). Some of the chamaephytes and pauciennials of the Festuca-Carlina grassland seem to be able to persist for some time in more open areas but they are soon overwhelmed by the taller herbage.""",
    'cg2':  """Most of the zonations within stands of the Festuca-Avenula grassland or between the community and other vegetation types are related to topographic and soil variation or represent stages in successions mediated by treatment. Gradations between different sub-communities related to topographic modifications of climate are relatively uncommon. In some areas, the local physiography is such that even quite extensive stretches of the community are predominantly of one aspect, as along the scarps of the North and South Downs. Elsewhere, the effect of exposition is confused by variations in treatment or stands are so fragmented that they do not encompass the range of possible aspects within a single site. However, in some places, uniform treatment prevails over rounded hills, scarp tops, circular or hemispherical ancient monuments or along the slopes of sharply-twisting valleys, and here transitions may be seen. In wetter regions, as on a very few localities on the South Downs, the Pseudoscleropodium-Prunella variant of the Cirsium-Asperula sub-community gives way, on south-facing slopes, to the Typical variant; in drier areas, such as parts of the Chiltern scarp, the Typical variant occupies north-facing slopes, passing to the Filipendula-Helianthemum variant on southerly expositions. To the west, as on hills and hill forts on the Dorset Chalk, or in the steep and narrow valleys of south-west Wiltshire, the Succisa-Leucanthemum sub-community is very characteristic of south-west aspects, grading to the Cirsium-Asperula sub-community (often the Pseudoscleropodium-Prunella variant) on north-facing slopes. Further north, there are a very few sites in the regional overlap of the Cirsium-Asperula and Dicranum sub-communities where these two vegetation types pass one into the other with a change in aspect, e.g. parts of Dovedale in Derbyshire and on the Great Orme in Gwynedd. Very often, however, in all these cases, a number of discrete stands of the Festuca-Avenula grassland are needed to include this kind of variation. Some edaphic differences are probably involved in these topoclimatic patterns (e.g. Perring 1958, 1959), but the effect of soil variation on zonations is much more clearly seen where sequences of profiles have developed over limestones partly overlain by different amounts and various kinds of superficial deposits. Strictly speaking, these soil sequences should not be described as catenas, because of the hybrid origin of some of the profiles (e.g. Balme 1953, Pigott 1962, Grime 1963b, Bryan 1967): the sharpness of the edaphic transitions and the related vegetation patterns depend very much on the disposition of the superficials which is, in turn, related to topography. In general, however, the sequences are marked by an increase in the extent of the soil cover and its depth, and a decline in the influence of the underlying calcareous bedrock on the development and character of the soils. In such situations, the Festuca-Avenula grassland can occur in suites of vegetation types which may run from very open calcicolous chasmophyte communities on exposed bedrock right through to heath over brown earths. As with aspect-related zonations, many such sequences have now been disturbed or disrupted by agricultural activity leaving modified remnants in disjunct array, but two kinds ofintact sequences can still be seen. The first occurs where flatter limestone surfaces have an uneven cover of superficial which thins in places to shallow native rendzinas or rock exposures. Such patterns are best seen on the characteristic benches which develop on Carboniferous Limestone where the Festuca-Avenula grassland often forms a narrow zone towards their outer edges, giving way to heath further back and to some kind of open calcicolous vegetation over the rocky bench edge (rarely with pavement outside the limits of the Final Glaciation where the community is mostly found). On the western coastal exposures of the Carboniferous Limestone in the Mendips and Wales, where these rocky cliff tops are often very hot and dry, some very distinctive zonations of this kind occur with various types of Festuca-Carlina grassland grading to Festuca-Avenula grassland (often through the Filipendula-Helianthemum variant of the Cirsium-Asperula sub-community), then to Nardo-Galion grasslands and heath (e.g. Proctor 1956, 1958, Shimwell 1968a, Rodwell 1974, South Gower Coast Report 1981). Sometimes, a more discontinuous cover of drift is reflected in complex mosaics of Festuca-Avenula grassland and heath (e.g. Gittins 1965a). Such patterns are rarer on the Chalk where the dipslope plateaus have been more systematically exploited for agriculture but fragments were described from Porton Down on the Hampshire/Wiltshire border by Wells et al. (1976) where rendzinas carrying some Festuca-Avenula grassland were replaced locally by brown earths over Tertiary cappings with Nardo-Galion grasslands. At Lullington Heath in Sussex, Grubb et al. (1969) found some transitions from heath to Festuca-Avenula grassland where practice blast-bombing had blown away a cover of loess from the Chalk surface leaving a man-made rendziniform soil. (The much more complete sequences described by Watt (1940 et seq.) from the Breckland Chalk are considered under the Festuca-Hieracium-Thymus grassland.) The second and much more widespread situation occurs where soil sequences develop over the graded slopes of valley sides and the more rounded scarps of softer limestones. Here, slope rendzinas with Festuca-Avenula grassland pass, with varying degrees of abruptness at the brow-top, to drift-derived soils with Nardo-Galion grasslands and heath. The zonations described from the Derbyshire Dales (Balme 1953, Pigott 1962, Grime 1963b, Shimwell 1968a, b) are of this kind and here, on the harder Carboniferous Limestone, the sequence may run on to screes and cliffs with a fragmentation of the Festuca-Avenula sward and its replacement by open fern-dominated or Thero-Airion vegetation on crevice protorendzinas. This element is usually lacking on the softer Chalk, although open communities do occur in those few places, as on river cliffs and in the gaps along the North and South Downs (e.g. Lousley 1950, Rose 1973), where bedrock is exposed. The basic sequence is, however, widespread in the south, although it is often truncated or fragmented by cultivation right to the scarp top and the conversion of the bulk of the dip slopes to arable (e.g. Hodgson 1967, Jarvis 1973, Cope 1976, Ratcliffe 1977, Jarvis et al. 1979). The particular sub-communities and variants of the Festuca-Avenula grassland involved in these zonations vary (largely in relation to regional and local climate) but especial interest attaches to the fact that the Holcus-Trifolium sub-community often forms a transition zone between the more calcicolous kind of Festuca-Avenula swards on the shallow rendzinas and the Nardo-Galion grasslands on the deeper brown earths. The soils under this sub-community are often contaminated with superficials as, for example, around deep drift deposits on plateaus or where, towards the upper parts of slopes, there is some downwash (Pigott 1962, Grime 1963b) but, in general, they approximate to the calcareous brown earth type (‘mull rendzina’ in the older terminology). They are deeper, moister and somewhat more mesotrophic than rendzinas and, at least towards their surface, less calcareous and of lower pH. Not only does this combination of features promote a lusher and more mesophytic kind of Festuca-Avenula grassland but it also creates conditions which allow the invasion of certain calcifuges and the development of mixed vegetation which gives way to calcifugous swards and heath over the deeper drift (e.g. Pigott 1962, Grime 1963a, b, Grubb et al. 1969, Rodwell 1974). There is some evidence that certain of the calcifugous invaders can acidify the soils in their rhizospheres (Grubb et al. 1969, Pigott 1970a) and this may allow a progressive advance of the Nardo-Galion grassland into the Festuca-Avenula swards, though some species of the Holcus-Trifolium sub-community can persist to provide the calcicolous element in what has become known as ‘Chalk heath’ or ‘limestone heath’. Grazing also affects such changes because, if it is relaxed, such competitive power as the surviving calcicoles retain may be lost as the sward grows rank. Many areas showing the more subtle zonations between the Festuca-Avenula grassland and heaths, especially those on the Chalk, have been lost since the demise of rabbits in the myxomatosis epidemic (e.g. Grubb et al. 1969, Ratcliffe 1977). There is one further kind of zonation related to interactions between soil and climate and that is the type of pattern which develops where Festuca-Avenula grasslands come under the influence of salt-spray on coastal limestone exposures. Maritime influence is relatively low within the community itself, partly because some limestones, like the Chalk along the Channel coast, typically form very high cliffs whose tops are out of reach of spray. Even where stands are close to the sea, the influence of high calcium levels can overwhelm the impact of small amounts of salt-deposition such that there are just very occasional records for species such as Plantago maritima and Armeria maritima in what is essentially a typical Festuca-Avenula sward. In some places, however, the community grades to more maritime vegetation with increasing salt-spray influence, as on low Chalk cliffs and on the Carboniferous Limestone of the Gower coast. The usual pattern is for the community to give way down the cliff to the Sanguisorba sub-community of the Festuca-Daucus grassland or, on ledges and slumped chunks of cliff, to the Brassica community. Both these vegetation types preserve a calcicolous element though, with the decreased accessibility to grazing stock on such sites, these transitions are often marked by a striking increase in taller herbs and tussocks of Brachypodium pinnatum. Although some small measure of serai change in the Festuca-Avenula grassland may occur in response to pedogenesis (see above), it is variation in grazing pressure that, above all, controls successions to and from the community. Whenever grazing is increased or relaxed to any marked degree, or when there are substantial shifts in the proportions of the different grazing animals, physiognomic and floristic changes ensue. These are easy to describe in general terms, though there are relatively few detailed studies on the subject. It is the effects of grazing relaxation that are nowadays the more obvious. With the general decline in sheep pastoralism since the First World War (Shrub 1973, Smith 1980) and the catastrophic reduction in the rabbit population in the 1954/5 myxomatosis epidemic (Lockley 1964, Sheail 1971), extensive areas of Festuca-Avenula grassland have become rank and overgrown by scrubby woodland (e.g. Ratcliffe 1977). The early enclosure experiment on a stand of the community at Downley Bottom A (Tansley 1922, Tansley & Adamson 1925, Hope-Simpson 1941b) and later observations (e.g. Hope-Simpson 1940b, Thomas 1960, 1963, Wells 1967a, 1969, 1973) give some indication of the processes involved. The first general change is that the sward grows taller and more uneven. Although there is often a flush of profuse flowering among the dicotyledons in the season after grazing ceases, it is the grasses which, in the longer term, make the most pronounced vegetative response. They produce more and lusher foliage which can accumulate, after death, as a layer of resistant litter and some develop a pronounced tussock habit. The increased competition for nutrients, water and, especially perhaps, for light, then begins to induce a second kind of general alteration in the sward, this time in its floristic composition. Some of the characteristic dicotyledons of the Festuca-Avenula grassland are quickly overwhelmed, e.g. Hieracium pilosella, Asperula cynanchica, Polygala spp. and the therophytes and more delicate bryophytes of patches of bare ground. Others can maintain their position for some time in the ranker herbage by producing larger rosettes which depress or grow through the grasses (e.g. Cirsium acaule, Sanguisorba minor, Plantago lanceolatd) or adopting a bushier habit and sprawling over them (e.g. Thymus praecox, T. pulegioides, Hippocrepis comosa, Helianthemum nummularium, Lotus corniculatus). Even here, however, there may be some reduction in flowering and seed production. Surviving plants may become very attenuated and eventually die and they cannot easily be replaced because there is little well-illuminated ground where seedlings can become established. As a result of these changes, the sward begins to assume the composition and structure of a different vegetation type. Where there is no rapid invasion into the ungrazed sward of shrubs and trees, the nature of the derived vegetation depends partly on which grasses gain eventual ascendance and partly on which particular kind of Festuca-Avenula grassland is involved. The two are not unrelated because certain grasses are especially characteristic of different sub-communities or variants or appear particularly suited to invade one type of sward rather than another. Floristic variation in the original sward also determines which range of dicotyledonous associates is available to respond to the abandonment of grazing and the expansion of the grasses. Of those grasses which are frequent throughout the community, Avenula pratensis and Daetylis glomerata often become prominent in these circumstances and, in the more mesophytic vegetation of the Holcus-Trifolium sub-community, Holcus lanatus can increase (e.g. Norman 1957, Kydd 1964). Even the more diminutive species such as Festuca ovina, Briza media and Koeleria macrantha can remain very frequent and locally abundant in ungrazed swards. For the most part, however, it is the coarser and much more aggressive tussock grasses that now begin to make their mark and become overwhelming dominants. The most important of these, at least over the southern part of the range of the community, are Bromus erectus and Brachypodium pinnatum. Both are present in small amounts as low-frequency occasionals in the Festuca-Avenula grassland, though they are less common, especially the former, in the northern Dicranum sub-community. They can also invade recently ungrazed swards, provided there is a seed source nearby, although they may not be able to gain new entry into grasslands which have already grown rank. Once established, they respond strikingly to relaxation of grazing, expanding to overwhelm the neighbouring turf and converting the vegetation to communities in which each or both are dominant. The development of Bromus erectus grassland is reversible with a resumption of hard grazing and, even where this species continues to increase, the death and decay of the centres of its expanding clones may allow the reappearance of something resembling a Festuca-Avenula sward (Austin 1968a). Brachypodium pinnatum is different. It is much less palatable and, once established, it can be extremely difficult to reduce, let alone eradicate. Even at the time of the earliest surveys (Tansley & Adamson 1925, Hope-Simpson 1940b, 1941b), grasslands dominated by these species were very widespread on the southern Chalk and they have continued to increase in extent since then. It is possible that some of the floristic variation within them is inherited from the original swards which they invaded. Both Bromus and Brachypodium grasslands exhibit a contrast between more calcicolous and more mesophytic types which reflects the distinction between the Cirsium-Asperula and Holcus-Trifolium sub-communities of the Festuca-Avenula grassland. There is a third coarse and aggressive tussock grass which may be especially able to take advantage of the more mesotrophic conditions of which the Holcus-Trifolium sub-community is characteristic. This is Arrhenatherum elatius, an occasional in these swards and a ready invader. Lack of grazing is a key factor in its expansion and it can quickly assume dominance to form an Arrhenatheretum, perhaps, in this case, of the kind included in the Centaurea nigra sub-community. It is, however, very palatable and resumption of grazing can reduce it to virtual insignificance in the sward (e.g. Thomas 1960, 1963, Wells 1969). Two further species are of importance here. Avenula pubescens is frequent in some kinds of Festuca-Avenula grassland, again more conspicuously in the more mesophytic Holcus-Trifolium sub-community but also in the Succisa-Leucanthemum sub-community, the floristics and environmental relationships of which are more complex. It, too, can increase very markedly when grazing is relaxed and some stands of grassland in which it is dominant may have developed from ungrazed Festuca-Avenula swards. Festuca rubra is a more complex case. It is, in these data, much more uneven in its occurrence than F. ovina, though it is invariably F. rubra which is reported as becoming the more prominent of the two with lack of grazing. It is certainly very characteristic of some kinds of ungrazed calcicolous grassland, often in association with A. pubescens, though at some localities, like Swyncombe Down in Oxfordshire (Smith et al. 1971) and Porton Down on the Hampshire/Wiltshire border (Wells et al. 1976), as an uncompromising dominant. Finally, and much more local in its importance, there is Brachypodium sylvaticum. This is a generally uncommon grass in Festuca-Avenula swards, assuming but patchy prominence under grazing and especially associated with stands over harder limestones (like many in the Dicranum sub-community) where, incidentally, it is by no means always an indicator of former woodland. It can expand when grazing is relaxed and, being relatively unpalatable (e.g. Wells 1969), is less easily eradicated than, say, A. elatius, but it rarely forms a major component of closed, ungrazed swards over intact soils. The relationships between each of these species and the ungrazed environment, including its edaphic and climatic characteristics, are complex and little understood. Moreover, these grasses can often expand or invade together, producing a further element of complexity in the derived communities. Also, many of the stands in which they are now dominant, either alone or in various combinations, originate not from ungrazed Festuca-Avenula swards but from much more grossly disturbed situations, as, for example, where calcicolous x§grassland has been ploughed and abandoned. Some of the intricacies of these relationships are examined under the descriptions of the various communities in which these species are dominant. Shrubs and trees can invade ungrazed Festuca-Avenula grassland rapidly if there are nearby seed sources, and the expansion and closure of a woody canopy may then proceed alongside or overtake changes in the herbaceous component of the vegetation (as in the Downley enclosure which was adjacent to a woodland). The most widespread early invaders seem to be Crataegus monogyna, Prunus spinosa, Rubus fruticosus agg., Rosa spp. and Ligustrum vulgare with, thinning northwards, Rhamnus catharticus and Cornus sanguinea and, around disturbed and enriched sites, Sambucus nigra. These can thicken up quite quickly to form stands of various kinds of Crataegus-Hedera scrub, the edges of which often become clothed in tangles of Clematis vitalba. A number of orchids, notably Aceras anthropo-phorum, Himantoglossum hircinum and the very rare Orchis militaris, are particularly associated with the ranker ungrazed Festuca-Avenula swards found around the margins of such scrub. Two much more local invaders which can form distinctive kinds of scrub are Juniperus communis ssp. communis and Buxus sempervirens. The further development of these communities to mixed deciduous, Fagus and Taxus woodlands is considered in the volume on Woodlands and Scrub. The consequences of very heavy grazing of Festuca-Avenula grasslands are now much more rarely seen than in the days ofrabbit infestation between the World Wars and into the 1950s when their impact became especially obvious with the decline in numbers of sheep. Then, their vociferous nibbling and scraping, their dunging and urinating on the sward and their excavations in the softer strata and superficial deposits, produced striking and very widespread effects (see, for example, plates 2 and 3 in Tansley 1939 and figure 5 in Hope-Simpson 1940b). In some areas, their numbers have risen again as less virulent strains of myxomatosis have stabilised within the population. Their general effect on the Festuca-Avenula grassland seems to be to convert it to the kind of vegetation that is included in the Festuca-Hieracium-Thymus grassland, the community on which most of the classic studies of the effects of rabbits have been carried out (Farrow 1917, Watt 1940 et seq.). Here, there is a marked reduction in the numbers and cover of more palatable grasses, sedges and dicotyledons and a rise to prominence of certain bryophytes, notably Hypnum cupressiforme, Homalothecium lutescens and Pseudoscleropodium purum, in the more open sward. Also, with the greater disturbance, there is an increase in weedy species, not only those therophytes which are characteristic of open areas within the Festuca-Avenula grassland, but also grosser species such as Senecio jacobaea, Erigeron acer and Fragaria vesca. It was the local abundance of these, together with patches of, for example, Urtica dioica, Arctium spp., Verbascum thapsus, Hyoscyamus niger, Atropa belladonna and Solanum dulcamara, often attaining a grand stature on the rich burrow spoil, that gave the old rabbit warrens their distinctive, and often highly peculiar, appearance (e.g. Tansley & Adamson 1925, Thomas 1960, 1963). Variations in grazing intensity in the Festuca-Avenula grassland have a very considerable impact, not only on the vegetation itself, but also on its often very characteristic invertebrate populations (e.g. Duffey 1962a, b, Duffey et al. 1974, Morris 1967, 1968, 1969, 1971a, b, 1973). The complex relationships between the numerous and varied species and the plants are an essential part of the Festuca-Avenula grassland environment and make themselves felt through inter-dependencies such as those involved in pollination. Many of these effects are subtle and hidden. One often very obvious impact of the invertebrate fauna on the vegetation, however, is that produced by the mound-building activities of ants, especially Lasius flavus (Thomas 1962, Grubb et al. 1969, Wells et al. 1976, King 1977a, b, c). The hills produced by this species are large and roughly hemispherical and they introduce an element of structural complexity into stands of the Festuca-Avenula grassland, especially on the southern Chalk, which long outlasts their occupation; indeed, the ant-hills may even outlast the grassland, persisting after the abandonment of grazing and beyond the development of a woodland cover. The soil of the ant-hills is structurally finer and less dense than that of the surrounding intact profiles, though it does not seem to be significantly different in its chemical properties. It is also more free-draining and subject to greater fluctuations of temperature, the drying and heating being especially marked on the southern face. The mounds are also subject to various kinds of disturbance by rabbits, which use them as latrines, and various ant-eating or dust-bathing birds. Both sheep and rabbits may graze them preferentially, especially where the surrounding vegetation has grown rank. These effects combine to produce a complex floristic mosaic within Festuca-Avenula swards which is subject to its own distinctive successional changes. In King’s studies, the most characteristic species of the ant-hills were of two kinds: those within the immediately surrounding sward which were more readily able to grow through or on to the accumulating soil (notably the chamaephytes Thymus praecox, Helianthemum nummularium, Cerastium fontanum and, to a lesser extent, Asperula cynanchica) and therophytes, virtually absent from the intact grassland but able to find a very congenial germination ground on the mounds (Arenaria serpyllifolia, Veronica arvensis). With ageing, but continued occupation, the vegetation seemed to stabilise with large amounts of T. praecox and H. nummularium but, on abandonment, other species, especially Hieracium pilosella, became conspicuous to form vegetation which appears to resemble that of the Festuca-Hieracium-Thymus grassland. Although hills produced by moles (Talpa europaed) are frequent in Festuca-Avenula grassland and may be confused with ant-hills (see King 1977a), they present a somewhat different disruption of the surface and show a less peculiar flora. Mole-holes are rapidly excavated in a single operation and are quickly eroded by rain and trampling by stock to ground-level. Their soil is not structurally sorted, being simply a disturbed pile of material, and it may contain seeds and vegetative fragments which can readily regenerate (King 1977a). Though there may be a temporary flush of therophytes on the mound, the vegetation seems quickly to return to that of the surrounding grassland. The aesthetic appeal of Festuca-Avenula swards has long made them popular for recreation which can entail heavy trampling and sometimes the driving or parking of vehicles on the vegetation. Around picnic spots, there may also be particular kinds of cultural eutrophication. In recent years, a declining number of stands has come under increasing pressure from a growing and more mobile population and some sites, as on the North Downs (Streeter 1971, Dixon 1973) or along the north Wales coast (Rodwell 1974), have become especially vulnerable. The distinctive springy turf of the community seems resilient to a certain amount of trampling but, where this is concentrated, as along paths and around viewing-points, clear changes occur in the vegetation. In such places, there is often a local increase in resistant grasses, notably Cynosurus cristatus, but in some cases also Dactylis glomerata, Agrostis stolonifera and Holcus lanatus, and in some of the rosette species, such as Plantago lanceolata, Bellis perennis and Taraxacum officinale agg., at the expense of more sensitive plants like the chamaephytes. This gives such swards a somewhat similar composition to the Holcus-Trifolium sub-community and recreational trampling may play a part in the development of some stands of this kind of Festuca-Avenula grassland. Typically, however, the sward lacks the tussocky physiognomy of this vegetation, being extremely short. Also, the further appearance in the turf of Lolium perenne, especially where there is some eutrophication, often presages a rapid move towards Lolio-Plantaginion vegetation. Very similar changes to these were observed by Perring (1967) with an increase in horse-galloping pressure on stretches of Newmarket Heath, Suffolk, used for race-horse exercising. Most unusually among Festuca-Avenula species, the rarity Pulsatilla vulgaris is actually benefited by heavy trampling, which stimulates the formation of new rosettes from deep adventitious root-buds (Wells & Barling 1971). Even where this species is present, however, very heavy pressure may eventually disrupt the sward, allow soil erosion and expose the bedrock.""",
    'cg3':  """Zonations involving the Bromus grassland are most often reflections of seral changes related to the intensity of grazing and sometimes complicated histories of ploughing and abandonment. Occasionally, the community may show an abrupt transition to disturbed, oligotrophic soils that cannot, apparently, be invaded by B. erectus (Lloyd 1964, Lloyd & Pigott 1967). More usually, it occurs in irregular patchworks with surviving areas of Festuca-Avenula grassland, other rank swards that have developed with a demise of grazing (e.g. the Brachypodium pinnatum and Avenula pubescens grasslands) and scrub. Such patterns have been described in detail from Lullington Heath in Sussex (Grubb et al. 1969), Barton Hills in Bedfordshire (Wells & Morris 1970) and Porton Down (Wells et al. 1976) and they are a common feature of many areas of the southern Chalk and Oolite (e.g. Ratcliffe 1977). In principle, the fact that B. erectus will be eaten by stock and rabbits means that its expansion in swards is reversible with a resumption of grazing (Hope-Simpson 1940b). In practice, this may be more complicated. For example, Wells (1971) showed how B. erectus maintained its cover in this kind of vegetation over shallow, rendziniform soils with quite heavy grazing, even increasing in extent on deeper loamy soils. It is therefore possible that swards may stabilise with a higher B. erectus cover and that really hard grazing, with no alternative, more palatable herbage, is necessary to effect any marked reduction. The high cost of this kind of pastoral control has focused attention on mowing as an alternative means of retaining or recovering the species-richness and diversity of those calcicolous swards where B. erectus can gain a hold. Wells (1971) demonstrated that cutting in spring, shortly after growth commenced in March, was effective in holding steady or reducing the cover of B. erectus, perhaps by depleting the newly-mobilised food reserves. Regrowth was then poor and other species were able to capitalise on the provision of space. Summer cutting sometimes encouraged the expansion of B. erectus, perhaps because of stimulating the production of tillers when growth was in full swing. Though mowing is unselective (and not always practical on very steep slopes), it can be precisely timed and this may have advantages in allowing selected species to flower and set seed (e.g. Wells 1969, 1971, 1973). Burning, though it has been more traditionally practised on grasslands with Brachypodium pinnatum, has sometimes been used as a means of controlling B. erectus which, in dry weather, is readily ignited with its accumulations of litter. It may not always be successful. Indeed, it may stimulate fresh growth in the cleaned sward and, though new shoots may be more eagerly eaten by stock, without grazing the B. erectus may simply resume its dominance. The subsequent successional development of Bromus grassland with the continued absence of grazing has never been followed in detail. Though stands of the community often occur in close association with scrub, we do not know how readily shrubs and trees can invade the ranker swards. Certainly, some stands, after rapid establishment following myxomatosis, seem to have remained substantially unchanged for 30 years. Large populations of field voles (Microtus agrestis) often become established in such litter-choked tussocky grasslands and these may play an important role in eating and barking seedlings of woody species (Smith 1980). Deliberate or accidental burning may also repeatedly set back any invasion and help maintain the vegetation as a plagioclimax. Where colonisation by B. erectus is more gradual or patchy, it is possible that shrubs and trees may become established in the more open turf or on anthills which are often abandoned as they become increasingly shaded by the tall grasses (Wells et al. 1976, King 1977c).""",
    'cg4':  """The various kinds of Brachypodium grassland, like those dominated by Bromus erectus, commonly occur in zonations which reflect seral changes related to grazing intensity, forming patchworks with Festuca-Avenula grassland, other rank swards and scrub as on the Wye and Crundale Downs in Kent (Green 1973), at Castor Hanglands on the Huntingdon/Peterborough Oolite (Duffey et al. 1974) and over the Chalk of the Yorkshire Wolds (NCC Yorkshire Chalk Grassland Survey 1985). More locally, the community occurs with more open weed vegetation and scrub on quarry spoil (e.g. Shimwell 1968a). Because of its unpalatability, the expansion of B. pinnatum seems to be reversible only with difficulty. Grazing with sheep alone, especially just in winter, is ineffective and even all year round grazing involving cattle may do no more than simply restrict further spread and reduce the pronounced tussocky character of the sward (Hope-Simpson 1940b), Green 1973). Likewise, burning alone, though cheaper than grazing, destroys accumulated litter but may not reduce the cover of B. pinnatum: indeed, it can encourage further expansion, though twice-yearly burns in alternate years may prevent this (Green 1973). More effective seem to be combinations of these treatments, for example a burn in very early spring followed by very hard grazing, preferably by cattle first, then sheep (Hope-Simpson 1940b, Green 1973). Sprinkling salt on the tussocks may encourage stock to eat the herbage (Hope-Simpson 1940b). The assiduous care needed in such treatments to avoid deleterious side effects such as poaching of the soil, always a danger where cattle are grazing steeper slopes, or loss of invertebrate populations with burning, and the difficulties of integrating them with recreational use of the grasslands, makes mowing an attractive alternative. Mowing with removal of the cuttings has been shown to be effective in maintaining less tussocky and more varied Brachypodium swards and reduction in the height of the herbage may induce rabbits to graze (Green 1973). The further development of ungrazed Brachypodium grasslands has not been monitored in detail. As with Bromus erectus, the dense tussocky nature of some of the swards and the high population of voles which this encourages, may hinder scrub invasion. Though B. pinnatum is actually palatable to Microtus agrestis (Godfrey 1953, 1955, Chitty et al. 1968), it is doubtful whether voles make great inroads on the cover of the species.""",
    'cg5':  """As with other lowland calcicolous grasslands, stands of the community are now very much restricted to slopes or abandoned quarries isolated within landscapes devoted largely to arable farming. On such sites, zonations are usually a reflection of seral progressions related to the intensity of grazing and/or burning. Over scarp slopes, the community occurs in patchworks with Festuca-Avenula grassland (usually of restricted occurrence over the Oolite), other rank swards dominated by B. erectus or B. pinnatum alone, scrub and woodland. In old quarries, zonations may involve more open weed vegetation on young or recently-disturbed spoil and rock faces. The details of seral changes involving this vegetation type have never been studied. It seems likely that, in quarries, the Hieracium sub-community could progress to the Typical sub-community with colonisation of exposed surfaces and that either sub-community, perhaps especially the more open Hieracium vegetation, is prone to invasion by shrubs and trees. Continued burning and grazing can, however, maintain the community as a plagioclimax and some of the more extensive stands occur on commons where public demands and/or ownership by conservation agencies provide incentives to their continued maintenance as open spaces."""
}

# here's the query to load communities data from the nvc sqlite database
load_communities_query = """
SELECT
  communities.community_level_code,
  communities.community_code,
  communities.community_name
FROM
  communities
"""

# column names to zip up with returned database columns to make them into dictionaries
column_names = ['community', 'code', 'name', 'list', 'succession']

# empty communities list, to be loaded up with dictionaries of zipped up field names with database rows
communities = list()
compressed_communities = list()


def find_compressed_community_names(name, name_list):
    compressed_community_name = ""
    ccn = list()
    name_list_copy = copy.deepcopy(name_list)
    hyphens = name.count("-")
    if (hyphens > 0):
        # print(name)
        ccn.append(name_list_copy.pop(0))
        # print(ccn)
        if name.count("sub-community") > 0:
            hyphens -= 1
        if name.count("salt-marsh") > 0:
            hyphens -= 1
        if name.count("drift-line") > 0:
            hyphens -= 1
        if name.count("snow-bed") > 0:
            hyphens -= 1
        
        for h in range(0, hyphens):
            split_name = name_list_copy.pop(0)
            if "-" in split_name:
                split_name_list = split_name.split("-")
                # print(split_name_list)
                split_name_list.pop(0)
                ccn.append(split_name_list.pop(0))
            # print(ccn)

        if len(ccn) > 1:
            compressed_community_name = ccn.pop(0)
            for i in ccn:
                compressed_community_name += "-" + i

        # print(compressed_community_name)
        return(compressed_community_name)


def process_compressed_community_names():

    for v in communities:
        found_compressed_community_name = find_compressed_community_names(v['name'], v['list'])
        # v['list'].append(found_compressed_community_name)
        # print(v)
        if found_compressed_community_name != "":
            # append the newly found community name to a list of compressed names
            fccn = { 'community': v['community'], 'code': v['code'], 'name': v['name'], 'ccn': found_compressed_community_name }
            # print(fccn)
            compressed_communities.append(fccn)


def load_table_from_database(database_name, query_string):
    con = sqlite3.connect(database_name)
    cur = con.cursor()

    for row in cur.execute(query_string):
        # print(row[0], row[1], row[2])
        current_row_list = list(row)
        current_row_list.append(list())  # names list
        current_row_list.append(list())  # succession pathways
        current_row = dict(zip(column_names, current_row_list))

        community_name = current_row['name']
        community_name_list = community_name.lower().split(" ")
        current_row['list'] = community_name_list
        # print(current_row)
        communities.append(current_row)

    con.close()


def mapstrip(s):
    return s.strip(".,:() ")


def find_communities(key, succession_string_list):
    # now we have the community names and codes loaded into the list communities
    # and the succession text for a community broken into the list succession_string_list
    # so now, iterate over the list succession_string_list, using the current word to search the community names
    # for the matching first word - then cycle through the next words for each looking for a match
    # use pre-prepared community names split into a list by " "

    recognised_communities = list()

    communities_iterator = communities.__iter__()
    # community_iterator = community.__iter__()
    for community in communities_iterator:
        word_iterator = succession_string_list.__iter__()
        for word in word_iterator:
            subcommander = 0
            while ((subcommander < len(community['list'])) and (community['list'][subcommander] == word)):
                # print("Found", subcommander, community['code'], word)
                if (subcommander > 1):
                    # print("Recognised", word, subcommander, community['community'], community['code'], community['name'])
                    # print("Record", key, "succeeds to", community['community'])
                    if (community['community'] not in recognised_communities):
                        recognised_communities.append(community['community'])

                subcommander += 1
                word = word_iterator.__next__()

    for word in succession_string_list:
        for community in compressed_communities:
            if community['ccn'] == word:
                # print("Found compressed", word, "in", community['community'])
                if community['community'] not in recognised_communities:
                    recognised_communities.append(community['community'])

    # print("For", key, "recognised succession communities", recognised_communities)
    return (recognised_communities)


def find_succession_pathways():
    for k, v in succession_texts.items():
        # print(k.upper())
        found = find_communities(k.upper(), list(map(mapstrip, v.lower().split(" "))))
        if len(found) > 0:
            print("Recognised", k.upper(), "successes to", found)
        else:
            print(k.upper(), "does not success")


load_table_from_database("nvc.db", load_communities_query)

process_compressed_community_names()

find_succession_pathways()